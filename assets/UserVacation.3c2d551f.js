import{j,r,c as _,w as q,af as F,h as N,g as B,aY as I,aL as M,U as Q,S as A,W as H,aV as L,Z as n,aN as C,Y as y,d as l,a0 as O,Q as g,a2 as k,aX as x}from"./index.ceb3bcee.js";import{Q as V}from"./QInput.34e81aee.js";import{e as Y,f as E,c as S,h as R,i as W,Q as X}from"./QTable.ad8b3c4f.js";import{Q as T}from"./QDate.3b0a3b32.js";import{Q as Z}from"./QForm.114c9ce6.js";import{Q as z,a as G}from"./QCard.c85750c6.js";import{Q as J}from"./QPage.406a2270.js";import{C as P}from"./ClosePopup.2f94db8d.js";import"./use-key-composition.2f75cb93.js";import"./use-cache.b0833c75.js";var U=j({name:"QPopupProxy",props:{...Y,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(u,{slots:o,emit:c,attrs:a}){const{proxy:d}=B(),{$q:f}=d,e=r(!1),m=r(null),b=_(()=>parseInt(u.breakpoint,10)),{canShow:p}=E({showing:e});function v(){return f.screen.width<b.value||f.screen.height<b.value?"dialog":"menu"}const i=r(v()),h=_(()=>i.value==="menu"?{maxHeight:"99vh"}:{});q(()=>v(),t=>{e.value!==!0&&(i.value=t)});function w(t){e.value=!0,c("show",t)}function s(t){e.value=!1,i.value=v(),c("hide",t)}return Object.assign(d,{show(t){p(t)===!0&&m.value.show(t)},hide(t){m.value.hide(t)},toggle(t){m.value.toggle(t)}}),F(d,"currentComponent",()=>({type:i.value,ref:m.value})),()=>{const t={ref:m,...h.value,...a,onShow:w,onHide:s};let D;return i.value==="dialog"?D=S:(D=R,Object.assign(t,{target:u.target,contextMenu:u.contextMenu,noParentEvent:!0,separateClosePopup:!0})),N(D,t,o.default)}}});const K={setup(){const u=M(),o=r(u.name),c=r(""),a=r(""),d=r(""),f=r(""),e=r(!1),m=()=>{e.value=!0},b=["\u4F8B\u5047","\u4E8B\u5047","\u75C5\u5047","\u516C\u5047","\u55AA\u5047","\u80B2\u5B30\u5047","\u7279\u4F11","\u5A5A\u5047","\u751F\u7406\u5047","\u7522\u5047","\u966A\u7522\u6AA2\u53CA\u966A\u7522\u5047","\u5B89\u80CE\u5047","\u80B2\u5B30\u7559\u8077\u505C\u85AA\u5047","\u5BB6\u5EAD\u7167\u9867\u5047"],p=Q([]),v=[{name:"\u59D3\u540D",field:"name",label:"\u59D3\u540D"},{name:"\u5047\u5225",field:"leaveType",label:"\u5047\u5225"},{name:"\u8D77\u59CB\u65E5\u671F",field:"startDate",label:"\u8D77\u59CB\u65E5\u671F"},{name:"\u7D50\u675F\u65E5\u671F",field:"endDate",label:"\u7D50\u675F\u65E5\u671F"},{name:"\u72C0\u614B",field:"state",label:"\u72C0\u614B"}],i=async()=>{try{const s=await C.get(`users/vacation/${u.name}`);console.log(s.data.message);let t=0;for(t=0;t<s.data.message.length;t++)p.push({name:s.data.message[t].name,leaveType:s.data.message[t].leaveType,startDate:s.data.message[t].startDate,endDate:s.data.message[t].endDate,state:s.data.message[t].state})}catch(s){console.log(s)}};i();const h=A();return{name:o,leaveType:c,startDate:a,endDate:d,showDialog:e,openDialog:m,leaveTypes:b,leaves:p,columns:v,submitForm:async()=>{try{const s=Q({name:o.value,leaveType:c.value,startDate:a.value,endDate:d.value,state:"\u5BE9\u6838\u4E2D"});e.value=!1;const t=await C.post("/users/vacation",s);console.log(t.data),h.notify({message:"\u7533\u8ACB\u6210\u529F",color:"positive"}),p.splice(0,p.length),i(),e.value=!1}catch(s){console.log(s)}},success:f}}},$={class:"move"},ee=y("h2",{class:"text-h5"},"\u4F11\u5047\u7533\u8ACB",-1),ae={class:"row items-center justify-end"},te={class:"row items-center justify-end"},oe=y("div",{class:"q-pa-md"},null,-1);function le(u,o,c,a,d,f){return H(),L(J,null,{default:n(()=>[y("div",$,[l(g,{onClick:a.openDialog,color:"primary",outline:"",class:"q-m-auto"},{default:n(()=>[O("\u6211\u8981\u7533\u8ACB\u4F11\u5047")]),_:1},8,["onClick"])]),l(S,{modelValue:a.showDialog,"onUpdate:modelValue":o[7]||(o[7]=e=>a.showDialog=e)},{default:n(()=>[l(z,null,{default:n(()=>[l(G,null,{default:n(()=>[ee,l(Z,{onSubmit:a.submitForm},{default:n(()=>[l(V,{outlined:"",modelValue:a.name,"onUpdate:modelValue":o[0]||(o[0]=e=>a.name=e),modelModifiers:{trim:!0},label:"\u540D\u7A31",rules:[e=>!!e===u.user.name||"\u6B64\u6B04\u4F4D\u70BA\u5FC5\u586B"],readonly:""},null,8,["modelValue","rules"]),l(W,{outlined:"",modelValue:a.leaveType,"onUpdate:modelValue":o[1]||(o[1]=e=>a.leaveType=e),label:"\u8ACB\u5047\u985E\u5225",options:a.leaveTypes,rules:[e=>!!e||"\u8ACB\u9078\u64C7\u8ACB\u5047\u985E\u5225"]},null,8,["modelValue","options","rules"]),l(V,{outlined:"",label:"\u958B\u59CB\u65E5\u671F",modelValue:a.startDate,"onUpdate:modelValue":o[3]||(o[3]=e=>a.startDate=e),mask:"date"},{append:n(()=>[l(k,{name:"calendar_today",class:"cursor-pointer"},{default:n(()=>[l(U,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[l(T,{modelValue:a.startDate,"onUpdate:modelValue":o[2]||(o[2]=e=>a.startDate=e),"today-btn":""},{default:n(()=>[y("div",ae,[x(l(g,{label:"\u78BA\u5B9A",color:"primary",flat:""},null,512),[[P]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(V,{outlined:"",label:"\u7D50\u675F\u65E5\u671F",modelValue:a.endDate,"onUpdate:modelValue":o[5]||(o[5]=e=>a.endDate=e),mask:"date",rules:[e=>e&&e>=a.startDate||"\u9700\u5927\u65BC\u8D77\u59CB\u65E5\u671F"]},{append:n(()=>[l(k,{name:"calendar_today",class:"cursor-pointer"},{default:n(()=>[l(U,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:n(()=>[l(T,{modelValue:a.endDate,"onUpdate:modelValue":o[4]||(o[4]=e=>a.endDate=e),"today-btn":""},{default:n(()=>[y("div",te,[x(l(g,{label:"\u78BA\u5B9A",color:"primary",flat:""},null,512),[[P]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"]),oe,l(g,{color:"primary",label:"\u9001\u51FA",type:"submit",class:"q-mt-md",onClick:a.submitForm},null,8,["onClick"]),l(g,{color:"red",label:"\u53D6\u6D88",onClick:o[6]||(o[6]=e=>a.showDialog=!1),class:"q-mt-md"})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(X,{id:"table",title:"\u8ACB\u5047\u660E\u7D30",rows:a.leaves,columns:a.columns,"row-key":"id"},null,8,["rows","columns"])]),_:1})}var ve=I(K,[["render",le]]);export{ve as default};
