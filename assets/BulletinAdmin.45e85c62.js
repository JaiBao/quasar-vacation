import{S as q,r,U as f,V as F,W as A,X as N,Y as V,d as l,Z as i,Q as d,F as S,aN as m,a0 as _}from"./index.ceb3bcee.js";import{Q as v}from"./QInput.34e81aee.js";import{Q as $}from"./QForm.114c9ce6.js";import{Q as T,a as j}from"./QCard.c85750c6.js";import{c as E,Q as I}from"./QTable.ad8b3c4f.js";import"./use-key-composition.2f75cb93.js";const W={class:"q-pa-md"},X={class:"row justify-end q-ma-lg"},L={__name:"BulletinAdmin",setup(Y){const u=q(),g=r(""),D=r(""),b=r(""),y=r(""),w=r(""),a=r([]),n=f({}),C=[{name:"title",align:"left",label:"\u6A19\u984C",field:"title"},{name:"content",align:"left",label:"\u5167\u5BB9",field:"content"},{name:"startDate",align:"center",label:"\u767C\u5E03\u65E5\u671F",field:"startDate"},{name:"endDate",align:"center",label:"\u622A\u6B62\u65E5\u671F",field:"endDate"},{name:"actions",align:"center",label:"\u72C0\u614B",field:"actions"}],s=f([]),c=r(!1),Q=()=>{c.value=!0},x=async()=>{try{console.log(n),await m.post("/bulletin/create",n),u.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u516C\u544A\u65B0\u589E\u6210\u529F"}),g.value="",y.value="",c.value=!1}catch(t){u.notify({color:"red-4",textColor:"white",icon:"cloud_off",message:t.message})}},p=async()=>{try{const t=await m.get("/bulletin");console.log(t);let e=0;for(e=0;e<t.data.result.length;e++)s.push({startDate:t.data.result[e].startDate,endDate:t.data.result[e].endDate,title:t.data.result[e].title,content:t.data.result[e].content,actions:t.data.result[e].actions,id:t.data.result[e]._id})}catch(t){u.notify({color:"red-4",textColor:"white",icon:"cloud_off",message:t.message})}};p();const h=async()=>{try{const t=f({id:a.value[0].id,title:a.value[0].title,content:a.value[0].content,startDate:a.value[0].startDate,endDate:a.value[0].endDate,actions:"\u9032\u884C\u4E2D"}),e=await m.patch("/bulletin/check",t);console.log(e),s.splice(0,s.length),p(),w.value="",g.value="",y.value="",D.value="",b.value=""}catch(t){u.notify({color:"red-4",textColor:"white",icon:"error",message:t.message||"\u767C\u751F\u932F\u8AA4"})}},k=async()=>{try{const t=f({id:a.value[0].id,title:a.value[0].title,content:a.value[0].content,startDate:a.value[0].startDate,endDate:a.value[0].endDate,actions:"\u5DF2\u7D50\u675F"}),e=await m.patch("/bulletin/check",t);console.log(e),s.splice(0,s.length),p(),w.value="",g.value="",y.value="",D.value="",b.value=""}catch(t){u.notify({color:"red-4",textColor:"white",icon:"error",message:t.message||"\u767C\u751F\u932F\u8AA4"})}},B=async()=>{var e;const t=await m.delete(`/bulletin/delete/${(e=a.value[0])==null?void 0:e.id}`);console.log(t),s.splice(0,s.length),p()};return(t,e)=>{const U=F("q-card-title");return A(),N(S,null,[V("div",W,[l(d,{onClick:Q,color:"primary",outline:"",class:"q-m-auto"},{default:i(()=>[_("\u65B0\u589E\u516C\u544A")]),_:1}),l(E,{modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=o=>c.value=o)},{default:i(()=>[l(T,null,{default:i(()=>[l(U,null,{default:i(()=>[_(" \u589E\u52A0\u65B0\u516C\u544A ")]),_:1}),l(j,null,{default:i(()=>[l($,{onSubmit:x},{default:i(()=>[l(v,{modelValue:n.title,"onUpdate:modelValue":e[0]||(e[0]=o=>n.title=o),label:"\u6A19\u984C",required:""},null,8,["modelValue"]),l(v,{modelValue:n.content,"onUpdate:modelValue":e[1]||(e[1]=o=>n.content=o),label:"\u5167\u5BB9",required:"",class:"content",type:"textarea"},null,8,["modelValue"]),l(v,{type:"date",modelValue:n.startDate,"onUpdate:modelValue":e[2]||(e[2]=o=>n.startDate=o),"today-btn":""},null,8,["modelValue"]),l(v,{type:"date",modelValue:n.endDate,"onUpdate:modelValue":e[3]||(e[3]=o=>n.endDate=o),"today-btn":""},null,8,["modelValue"]),l(d,{type:"submit",label:"\u589E\u52A0\u516C\u544A",color:"primary"}),l(d,{label:"\u53D6\u6D88",color:"red",onClick:e[4]||(e[4]=o=>c.value=!1)})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(I,{title:"\u516C\u544A",rows:s,columns:C,"row-key":"id",selected:a.value,"onUpdate:selected":e[6]||(e[6]=o=>a.value=o),"virtual-scroll":"",selection:"single"},null,8,["rows","selected"])]),V("div",X,[l(d,{icon:"upload",color:"green",label:"\u4E0A\u67B6",onClick:h}),l(d,{icon:"file_upload_off",color:"primary",label:"\u4E0B\u67B6",onClick:k}),l(d,{icon:"delete",color:"red",label:"\u522A\u9664",onClick:B})])],64)}}};export{L as default};
