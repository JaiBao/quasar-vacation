import{j as U,aT as q,aU as k,c as A,h as $,l as B,S as N,r as v,U as S,W as g,X as I,Y as d,d as l,Z as o,aV as b,Q as c,aW as h,F as T,aN as _,a2 as D,aO as E,aX as y}from"./index.769d91c3.js";import{Q as u}from"./QInput.10140e3a.js";import{Q as F}from"./QImg.348f209c.js";import{Q as P}from"./QTd.78eccd3d.js";import{Q as W,c as X}from"./QTable.37a609bb.js";import{Q as j,a as n}from"./QCard.6b978278.js";import{C as x}from"./ClosePopup.90b09e09.js";import"./use-key-composition.4cfb81be.js";var z=U({name:"QCardActions",props:{...q,vertical:Boolean},setup(p,{slots:i}){const a=k(p),r=A(()=>`q-card__actions ${a.value} q-card__actions--${p.vertical===!0?"vert column":"horiz row"}`);return()=>$("div",{class:r.value},B(i.default))}});const O={class:"q-pa-md text-right"},Y=d("div",{class:"text-h6"},"\u6703\u54E1id",-1),Z=d("div",{class:"text-h6"},"\u59D3\u540D",-1),G=d("div",{class:"text-h6"},"\u5E33\u865F",-1),H=d("div",{class:"text-h6"},"\u5BC6\u78BC",-1),J=d("div",{class:"text-h6"},"\u624B\u6A5F",-1),K=d("div",{class:"text-h6"},"\u89D2\u8272:\u7BA1\u7406\u54E1:1 \u4F7F\u7528\u8005:0",-1),se={__name:"UserAdmin",setup(p){const i=N(),a=v([]),r=v(!1),f=v(""),Q=[{name:"id",required:!0,label:"\u6703\u54E1id",align:"left",field:"id",sortable:!0},{name:"name",align:"left",label:"\u59D3\u540D",field:"name",sortable:!0},{name:"account",align:"left",label:"\u5E33\u865F",field:"account",sortable:!0},{name:"phone",label:"\u96FB\u8A71",field:"phone",sortable:!0},{name:"role",label:"\u89D2\u8272",field:"role",sortable:!0}],m=S([]),V=async()=>{try{const s=await _.get("/users/all");console.log(s.data.message);let e=0;for(e=0;e<s.data.message.length;e++)m.push({name:s.data.message[e].name,account:s.data.message[e].account,phone:s.data.message[e].phone,id:s.data.message[e]._id,role:s.data.message[e].role})}catch(s){console.log(s)}};V();const w=async()=>{var e;const s=await _.delete(`/users/delete/${(e=a.value[0])==null?void 0:e.id}`);console.log(s),m.splice(0,m.length),V()},C=async()=>{var s;try{console.log(a==null?void 0:a.value[0]),await _.patch(`/users/admin/${(s=a.value[0])==null?void 0:s.id}`,a.value[0]),await i.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"\u4FEE\u6539\u6210\u529F"})}catch(e){i.notify({color:"red-4",textColor:"white",icon:"info",message:e.message})}};return(s,e)=>(g(),I(T,null,[d("div",O,[l(W,{class:"table",title:"\u6703\u54E1\u7BA1\u7406",rows:m,columns:Q,"row-key":"id",selection:"single",selected:a.value,"onUpdate:selected":e[1]||(e[1]=t=>a.value=t),filter:f.value},{"top-right":o(()=>[l(u,{borderless:"",dense:"",debounce:"300",modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),placeholder:"Search"},{append:o(()=>[l(D,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-image":o(t=>[l(P,{props:t},{default:o(()=>[l(E,null,{default:o(()=>[l(F,{src:`https://source.boringavatars.com/beam/${t.row.name}?colors=ffabab,ffdaab,ddffab,abe4ff,d9abff`},null,8,["src"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","selected","filter"]),a.value[0]?(g(),b(c,{key:0,icon:"edit_note",color:"info",label:"\u7DE8\u8F2F",onClick:e[2]||(e[2]=t=>r.value=!0)})):h("",!0),a.value[0]?(g(),b(c,{key:1,icon:"delete",color:"red",label:"\u522A\u9664",onClick:w})):h("",!0)]),l(X,{modelValue:r.value,"onUpdate:modelValue":e[9]||(e[9]=t=>r.value=t),persistent:""},{default:o(()=>[l(j,{style:{width:"400px"}},{default:o(()=>[l(n,null,{default:o(()=>[Y]),_:1}),l(n,{class:"q-pt-none"},{default:o(()=>[l(u,{outline:"",modelValue:a.value[0].id,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value[0].id=t),readonly:""},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[Z]),_:1}),l(n,{class:"q-pt-none"},{default:o(()=>[l(u,{outline:"",type:"text",modelValue:a.value[0].name,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value[0].name=t)},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[G]),_:1}),l(n,{class:"q-pt-none"},{default:o(()=>[l(u,{outline:"",type:"text",modelValue:a.value[0].account,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value[0].account=t)},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[H]),_:1}),l(n,{class:"q-pt-none"},{default:o(()=>[l(u,{outline:"",type:"password",modelValue:a.value[0].password,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value[0].password=t)},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[J]),_:1}),l(n,{class:"q-pt-none"},{default:o(()=>[l(u,{outline:"",type:"text",modelValue:a.value[0].phone,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value[0].phone=t)},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[K]),_:1}),l(n,{class:"q-pt-none"},{default:o(()=>[l(u,{outline:"",type:"text",modelValue:a.value[0].role,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value[0].role=t)},null,8,["modelValue"])]),_:1}),l(z,{align:"right",class:"text-primary"},{default:o(()=>[y(l(c,{flat:"",label:"\u53D6\u6D88"},null,512),[[x]]),y(l(c,{flat:"",label:"\u66F4\u6539",onClick:C},null,512),[[x]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{se as default};
